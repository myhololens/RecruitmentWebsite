function getObjectURL(file) {
    var url = null ;
    if (window.createObjectURL!=undefined) { // basic
        url = window.createObjectURL(file) ;
    } else if (window.URL!=undefined) { // mozilla(firefox)
        url = window.URL.createObjectURL(file) ;
    } else if (window.webkitURL!=undefined) { // webkit or chrome
        url = window.webkitURL.createObjectURL(file) ;
    }
    return url ;
}

function check_img0() {
    $("#img_0").change(function(){
        var objUrl = getObjectURL(this.files[0]) ;
        if (objUrl) {
            $("#person_img_0").attr("src", objUrl).css("display",'inline');
        };
        $.ajaxSetup({
            headers: {
                'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
            }
        });
        var formData = new FormData();
        formData.append('file', $('#img_0')[0].files[0]);
        $.ajax({
            url: '/upload/picture',
            type: 'post',
            cache: false,
            data: formData,
            processData: false,
            contentType: false
        }).done(function(res) {
            console.info(res)
            $('#picture_0').val(res.file);
        }).fail(function(res) {});

    })
}
function check_img1() {
    $("#img_1").change(function(){
        var objUrl = getObjectURL(this.files[0]) ;
        if (objUrl) {
            $("#person_img_1").attr("src", objUrl).css("display",'inline');
        };
        $.ajaxSetup({
            headers: {
                'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
            }
        });
        var formData = new FormData();
        formData.append('file', $('#img_1')[0].files[0]);
        $.ajax({
            url: '/upload/picture',
            type: 'post',
            cache: false,
            data: formData,
            processData: false,
            contentType: false
        }).done(function(res) {
            console.info(res)
            $('picture_1').val(res.file);
        }).fail(function(res) {});

    })
}
function check_img2() {
    $("#img_2").change(function(){
        var objUrl = getObjectURL(this.files[0]) ;
        if (objUrl) {
            $("#person_img_2").attr("src", objUrl).css("display",'inline');
        };
        $.ajaxSetup({
            headers: {
                'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
            }
        });
        var formData = new FormData();
        formData.append('file', $('#img_2')[0].files[0]);
        $.ajax({
            url: '/upload/picture',
            type: 'post',
            cache: false,
            data: formData,
            processData: false,
            contentType: false
        }).done(function(res) {
            console.info(res)
            $('#picture_2').val(res.file);
        }).fail(function(res) {});
    })
}


$(function () {
    var a=1;
        $("#addMember").click(function () {
            if(a<3) {
            $("#memberForm_0").append(
                ' <div id="memberDiv'+0+'> <div class="formWrapper"> <div class="new_portrait" style="position: absolute;right: -200px;">' +
                ' <div class="portrait_upload" id="portraitNo0"> <span>上传创始人头像</span> </div> ' +
                '<input type="file" id="img_'+a+'" name="img_'+a+'"  accept="image/png,image/jpg,image/jpeg,image/gif" onclick="check_img'+a+'()">' +
                ' <img src="" id="person_img_'+a+'" width="120" height="120" style="display: none;position: absolute;top: 120px"> ' +
                '<input type="hidden" value="" name="picture_'+a+'" id="picture_'+a+'"> </div> <h3>创始人姓名</h3> ' +
                '<input type="text" placeholder="请输入创始人姓名" name="name_'+a+'" id="name_'+a+'" class="s_input1 valid"> ' +
                '<h3>当前职位</h3> <input type="text" placeholder="请输入当前职位，如：创始人兼CEO" name="position_'+a+'" id="position_'+a+'" class="s_input1 valid">' +
                ' <h3>新浪微博</h3> <input type="text" placeholder="请输入创始人新浪微博地址" name="weibo_'+a+'" id="weibo_'+a+'"> <h3>创始人简介</h3> ' +
                '<textarea placeholder="请输入该创始人的个人履历等，建议按照时间倒序分条展示" maxlength="1000" name="desc_'+a+'" id="desc_'+a+'"></textarea> ' +
                ' </div> </div> <div class="clear" style="width: 100%;margin-top:30px;border-bottom: 1px solid silver"></div>');
              a++;
                if(a>2){
                    $("#addMember").hide();
                }
            }
        });
    $("#step3Submit").click(function (){
        $("#memberForm_0").submit();
        // window.location.href ="index4Product.html";
    })
});